---
title: "Atos Project"
output: rmdformats::readthedown

---

# Performance and Feature Importance Report

## An overview of this report

This report presents the performance and feature importance of prediction models of four outcomes:

+ Remission

+ Past month heroin use

+ OD

+ Mortality

Also to address two questions:

1.	Do you agree with these predictors or should we add more?
```{r, echo=FALSE}

load("~/OneDrive - Universite de Montreal/Usydney/data.RData")

preds

```

2.	This is the list of the columns of HU OD 1 5 10y model.sav
```{r echo=FALSE}
colnames( data_Atos)

``` 
And this is the list of the outcomes
```{r echo=FALSE}
Out_Comes=c("STA_1YR","STA_5YR","MTA_5YR","STA_10YR","MTA_10YR","LTA_10yr","HU_1YR","HU_5YR","HU_10YR","OD_upto1YR","OD_upto5YR","OD_upto10YR","DEATH_1YR","DEATH_5YR","DEATH_10YR","DEATH_15YR")

Out_Comes
``` 
Some are available in the file 
```{r echo=FALSE}
Out_Comes[(Out_Comes%in%colnames( data_Atos))]
``` 
Some are not available in the file
```{r echo=FALSE}
Out_Comes[!(Out_Comes%in%colnames( data_Atos))]
rm(list = ls())
``` 

```{r include=FALSE}
library(haven)
library(tidyverse)
library(tidymodels)
library(stacks)
library(vip)
library(pdp)
library(sparkline)
library(plotly)
```





## Past month heroin use {.tabset}

### HU_1YR

#### Performance
```{r, echo=FALSE}

load("~/Statistical-Supplementary-Materials/Atos/HU_1YR_vips.RData")
 ens_mod_pred%>% accuracy(truth = HU_1YR, .pred_class)%>%bind_rows(ens_mod_pred%>% f_meas(truth = HU_1YR, .pred_class))%>%knitr::kable()

```


#### Feature Importance
```{r, echo=FALSE}
p=ggplot(vips,aes(x=reorder(Variable, importance),y=importance))+
  scale_fill_gradient(low = "green", high = "red") + 
  geom_bar(position="dodge", stat="identity", aes(fill = importance))+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  xlab("Predictor")+ ylab("Importance Rank")

ggplotly(p)
rm(list = ls())
```

### HU_5YR

#### Performance
```{r, echo=FALSE}
load("~/Statistical-Supplementary-Materials/Atos/HU_5YR_vips.RData")
ens_mod_pred%>% accuracy(truth = HU_5YR, .pred_class)%>%bind_rows(ens_mod_pred%>% f_meas(truth = HU_5YR, .pred_class))%>%knitr::kable()
```


#### Feature Importance


```{r, echo=FALSE}
p=ggplot(vips,aes(x=reorder(Variable, importance),y=importance))+
  scale_fill_gradient(low = "green", high = "red") + 
  geom_bar(position="dodge", stat="identity", aes(fill = importance))+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  xlab("Predictor")+ ylab("Importance Rank")

ggplotly(p)
rm(list = ls())
```


### HU_10YR

#### Performance

```{r, echo=FALSE}
load("~/Statistical-Supplementary-Materials/Atos/HU_10YR_vips.RData")
ens_mod_pred%>% accuracy(truth = HU_10YR, .pred_class)%>%bind_rows(ens_mod_pred%>% f_meas(truth = HU_10YR, .pred_class))%>%knitr::kable()
```


#### Feature Importance



```{r, echo=FALSE}
p=ggplot(vips,aes(x=reorder(Variable, importance),y=importance))+
  scale_fill_gradient(low = "green", high = "red") + 
  geom_bar(position="dodge", stat="identity", aes(fill = importance))+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  xlab("Predictor")+ ylab("Importance Rank")

ggplotly(p)
rm(list = ls())
```

## Remission {.tabset}

### STA_1YR

#### Performance



#### Feature Importance



### STA_5YR

#### Performance



#### Feature Importance



### MTA_5YR

#### Performance



#### Feature Importance



### STA_10YR

#### Performance


#### Feature Importance



### MTA_10YR

#### Performance



#### Feature Importance



### LTA_10yr

#### Performance



#### Feature Importance





## OD {.tabset}


### DEATH_1YR

#### Performance



#### Feature Importance



### DEATH_5YR

#### Performance



#### Feature Importance



### DEATH_10YR

#### Performance



#### Feature Importance




## Mortality {.tabset}


### DEATH_1YR

#### Performance



#### Feature Importance



### DEATH_5YR

#### Performance



#### Feature Importance



### DEATH_10YR

#### Performance



#### Feature Importance



### DEATH_15YR

#### Performance



#### Feature Importance

